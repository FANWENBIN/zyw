$(function(){var t={isJoin:!1},n={init:function(){$(".join").on("click",n.join),$(".join").on("mouseenter",n.joinEnter),$(".join").on("mouseout",n.joinOut),$(".submitmessage").on("click",n.submit),n.testJoin()},submit:function(){var t=editor.html();editor.sync(),t=$("#editor_id").val();var n=$(".articletitle").val();return console.log(n,t),t&&n?void $.ajax({type:"post",url:"./index.php?m=Home&c=Rice&a=postini",data:{fansclubid:$(".webmain").data("id"),title:n,content:t},dataType:"json",success:function(t){0===t.status?(console.log(t.msg),window.location.reload()):101===t.status?(console.log(t.msg),alert("发送失败，请稍后再试")):102===t.status&&(console.log(t.msg),alert("请先登录后再发帖"))},error:function(){}}):(alert("请确认该贴标题或内容是否填写！"),!1)},joinEnter:function(){t.isJoin&&$(this).html("退团")},joinOut:function(){t.isJoin&&$(this).html("已入团")},release:function(){$.ajax({type:"get",url:"./index.php?m=Home&c=Rice&a=quitfans",data:{fansid:$(".webmain").data("id")},dataType:"json",success:function(n){console.log(n.msg),0===n.status?(t.isJoin=!1,$(".join").html("+入团")):101===n.status?alert("系统错误，请稍后再试"):102===n.status&&alert("饭团未关注")},error:function(){}})},join:function(){t.isJoin?n.release():$.ajax({type:"get",url:"./index.php?m=Home&c=Rice&a=joinfans",data:{fansid:$(".webmain").data("id")},dataType:"json",success:function(n){console.log(n.msg),0===n.status?($(".join").html("已入团"),t.isJoin=!0):101===n.status?alert("加入失败，请稍后再试"):102===n.status?alert("请先登陆后再尝试"):103===n.status?alert("加入失败，请稍后再试"):104===n.status&&$(".join").html("已入团")},error:function(){}})},testJoin:function(){$.ajax({type:"get",url:"./index.php?m=Home&c=Rice&a=checkjoin",data:{fansid:$(".webmain").data("id")},dataType:"json",success:function(n){console.log(n.msg),1===n.status?(t.isJoin=!0,$(".join").html("已入团")):0===n.status&&(t.isJoin=!0,$(".join").html("+ 入团"))},error:function(){}})}};n.init()});
$(function(){var t={isJoin:!1},o={init:function(){$(".join").on("click",o.join),$(".join").on("mouseenter",o.joinEnter),$(".join").on("mouseout",o.joinOut),$(".submitmessage").on("click",o.submit),o.testJoin()},submit:function(){var t=editor.html();editor.sync(),t=$("#editor_id").val();var o=$(".articletitle").val();return console.log(o,t),t&&o?void $.ajax({type:"post",url:"./index.php?m=Home&c=Rice&a=postini",data:{fansclubid:$(".webmain").data("id"),title:o,content:t},dataType:"json",success:function(t){0===t.status?(console.log(t.msg),window.location.reload()):101===t.status?(console.log(t.msg),alert("发送失败，请稍后再试")):102===t.status&&(console.log(t.msg),alert("请先登录后再发帖"))},error:function(){}}):(alert("请确认该贴标题或内容是否填写！"),!1)},joinEnter:function(){t.isJoin&&$(this).html("退团")},joinOut:function(){t.isJoin&&$(this).html("已入团")},release:function(){$.ajax({type:"get",url:"./index.php?m=Home&c=Rice&a=quitfans",data:{fansid:$(".webmain").data("id")},dataType:"json",success:function(o){console.log(o.msg),0===o.status?(t.isJoin=!1,$(".join").html("+入团")):101===o.status?alert("系统错误，请稍后再试"):102===o.status&&alert("饭团未关注")},error:function(){}})},join:function(){t.isJoin?o.release():$.ajax({type:"get",url:"./index.php?m=Home&c=Rice&a=joinfans",data:{fansid:$(".webmain").data("id")},dataType:"json",success:function(t){0===t.status?(console.log(t.msg),$(".join").html("已入团")):101===t.status?(console.log(t.msg),alert("加入失败，请稍后再试")):102===t.status?(console.log(t.msg),alert("请先登陆后再尝试")):103===t.status?(console.log(t.msg),alert("加入失败，请稍后再试")):104===t.status&&(console.log(t.msg),$(".join").html("已入团"))},error:function(){}})},testJoin:function(){$.ajax({type:"get",url:"./index.php?m=Home&c=Rice&a=checkjoin",data:{fansid:$(".webmain").data("id")},dataType:"json",success:function(o){console.log(o.msg),1===o.status?(t.isJoin=!0,$(".join").html("已入团")):0===o.status&&(t.isJoin=!0,$(".join").html("+ 入团"))},error:function(){}})}};o.init()});